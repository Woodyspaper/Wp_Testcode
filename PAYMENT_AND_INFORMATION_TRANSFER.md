# Payment Processing & Information Transfer Guide
**Complete Explanation: What Gets Transferred & How Payment Works**

**Date:** January 5, 2026

---

## âœ… **WHAT INFORMATION IS TRANSFERRED TO COUNTERPOINT**

### **Customer Information:**
âœ… **Customer Name** â†’ `AR_CUST.NAM`  
âœ… **Customer Email** â†’ `AR_CUST.EMAIL_ADRS_1`  
âœ… **Customer Phone** â†’ `AR_CUST.PHONE_1`  
âœ… **Billing Address** â†’ `AR_CUST` (ADRS_1, CITY, STATE, ZIP_COD, etc.)  
âœ… **Shipping Address** â†’ `AR_SHIP_ADRS` (linked via `SHIP_TO_CONTACT_ID`)  
âœ… **Shipping Phone** â†’ `AR_SHIP_ADRS.PHONE_1`

### **Order Information:**
âœ… **Order Date** â†’ `PS_DOC_HDR.TKT_DT`  
âœ… **Order Number** â†’ `PS_DOC_HDR.TKT_NO` (auto-generated by CounterPoint)  
âœ… **Line Items** â†’ `PS_DOC_LIN` (SKU, quantity, price, extended price)  
âœ… **Order Totals** â†’ `PS_DOC_HDR_TOT` (subtotal, tax, shipping, grand total)  
âœ… **Shipping Method** â†’ `PS_DOC_HDR.SHIP_VIA_COD`

### **What is NOT Transferred:**
âŒ **Payment Method** â†’ Stored in staging (`PMT_METH`) but NOT in CounterPoint orders  
âŒ **Payment Status** â†’ Not tracked in CounterPoint  
âŒ **Payment Transaction ID** â†’ Not transferred  
âŒ **Customer Order Notes** â†’ Not currently captured

---

## ğŸ’³ **HOW PAYMENT WORKS**

### **Payment Processing Location:**

**âœ… Payment is Processed on WooCommerce Side (woodyspaper.com)**

**Flow:**
1. Customer places order on woodyspaper.com
2. **Payment gateway (NMI) processes payment** on WooCommerce side
3. Payment is captured/authorized immediately
4. Order status changes to "processing" or "completed" (indicates payment successful)
5. **Only paid orders are pulled** into CounterPoint

### **Why Payment is NOT in CounterPoint:**

**CounterPoint Design:**
- CounterPoint orders (`PS_DOC_HDR`) are created **without payment information**
- Payment is a **separate process** in CounterPoint (handled via `PS_DOC_PAY` table)
- Orders can exist in CounterPoint as "unpaid" orders
- Payment can be applied later in CounterPoint if needed

**Our System Design:**
- We only pull orders that are **already paid** (status = "processing" or "completed")
- Payment was already processed by WooCommerce payment gateway
- CounterPoint just needs the order information, not payment details
- Payment method is stored in staging for reference but not transferred

---

## ğŸ” **HOW TO KNOW IF AN ORDER WAS PAID**

### **Method 1: Check WooCommerce Order Status**

**In WordPress Admin:**
- Go to **Orders** â†’ Find the order
- Check **Status** field:
  - âœ… **"Processing"** = Payment successful, order paid
  - âœ… **"Completed"** = Payment successful, order fulfilled
  - âŒ **"Pending Payment"** = Payment not yet received
  - âŒ **"Failed"** = Payment failed
  - âŒ **"Cancelled"** = Order cancelled

**What We Pull:**
- Our system **only pulls orders with status "processing" or "completed"**
- This means **all orders in CounterPoint were already paid** on WooCommerce

### **Method 2: Check Order Notes in WooCommerce**

**Look for payment confirmation:**
- "NMI charge completed (Charge ID: XXXXX)"
- "Payment via Credit Card (XXXXX)"
- "Paid on [date]"

### **Method 3: Check Staging Table (For Reference)**

**SQL Query:**
```sql
SELECT 
    WOO_ORDER_ID,
    ORD_STATUS,        -- "processing" or "completed" = paid
    PMT_METH,         -- Payment method (e.g., "Credit Card")
    TOT_AMT           -- Order total
FROM dbo.USER_ORDER_STAGING
WHERE WOO_ORDER_ID = 15487
```

**What This Shows:**
- `ORD_STATUS` = "processing" or "completed" â†’ **Order was paid**
- `PMT_METH` = Payment method used (for reference only)

### **Method 4: Check CounterPoint Order (Does NOT Show Payment)**

**âš ï¸ Important:** CounterPoint orders do NOT show payment status

**What You'll See:**
- Order exists in CounterPoint â†’ Order was created
- Order has totals â†’ Order amount
- **NO payment information** â†’ Payment is not tracked in CounterPoint order

**Why:**
- Payment was already processed on WooCommerce side
- CounterPoint doesn't need payment info to create the order
- Payment is a separate process in CounterPoint (if you want to track it there)

---

## ğŸ“Š **COMPLETE INFORMATION FLOW**

### **Step-by-Step Payment & Transfer Process:**

1. **Customer Places Order on woodyspaper.com**
   - Customer enters payment information
   - Payment gateway (NMI) processes payment
   - Payment is captured/authorized

2. **WooCommerce Updates Order Status**
   - Status â†’ "processing" (payment successful)
   - Order note added: "NMI charge completed"
   - Order is ready for fulfillment

3. **Our System Pulls Order (Only Paid Orders)**
   - Script checks for orders with status "processing" or "completed"
   - **Only paid orders are pulled** (unpaid orders are skipped)
   - Order data copied to `USER_ORDER_STAGING`

4. **Order Created in CounterPoint**
   - Customer information â†’ `AR_CUST` and `AR_SHIP_ADRS`
   - Order header â†’ `PS_DOC_HDR`
   - Line items â†’ `PS_DOC_LIN`
   - Totals â†’ `PS_DOC_HDR_TOT`
   - **Payment information is NOT transferred**

5. **Status Synced Back to WooCommerce**
   - CounterPoint note added: "Order created in CounterPoint. DOC_ID: X, TKT_NO: Y"
   - Order status remains "processing"

---

## âœ… **VERIFICATION: IS THE ORDER PAID?**

### **Quick Check:**

**If order exists in CounterPoint:**
- âœ… **Order was paid** (we only pull paid orders)
- âœ… Payment was processed on WooCommerce side
- âœ… Payment gateway (NMI) captured the payment

**To Verify Payment Details:**
- Check WooCommerce order page â†’ Look for payment confirmation
- Check order notes â†’ "NMI charge completed" or "Paid on [date]"
- Check staging table â†’ `ORD_STATUS` = "processing" or "completed"

**CounterPoint Will NOT Show:**
- Payment method
- Payment status
- Payment transaction ID
- Whether order was paid

---

## ğŸ¯ **SUMMARY**

### **What Gets Transferred:**
âœ… All customer information (name, email, phone, addresses)  
âœ… All order information (items, quantities, prices, totals)  
âœ… Shipping information  
âŒ Payment information (not needed, already processed)

### **Payment Processing:**
âœ… **Payment is processed on WooCommerce side** (woodyspaper.com)  
âœ… Payment gateway (NMI) handles payment  
âœ… Only paid orders are pulled into CounterPoint  
âŒ Payment information is NOT transferred to CounterPoint

### **How to Know if Order Was Paid:**
1. âœ… Check WooCommerce order status ("processing" or "completed" = paid)
2. âœ… Check WooCommerce order notes (payment confirmation)
3. âœ… If order exists in CounterPoint â†’ It was paid (we only pull paid orders)
4. âŒ CounterPoint does NOT show payment status

### **Bottom Line:**
- **Payment happens on WooCommerce side** (woodyspaper.com)
- **All paid orders automatically transfer to CounterPoint**
- **CounterPoint receives order information, not payment information**
- **If order is in CounterPoint, it was already paid on WooCommerce**

---

## ğŸ“ **EXAMPLE: Order #15487 (OSCAR GOMEZ)**

**WooCommerce Side:**
- Status: "Processing" âœ… (paid)
- Payment: "Credit Card (11069405339)" âœ…
- Note: "NMI charge completed" âœ…
- Total: $67.20 âœ…

**CounterPoint Side:**
- Order Created: Ticket #101-000004 âœ…
- Customer: 10057 âœ…
- Totals: $67.20 âœ…
- **Payment Info: NOT shown** (not needed)

**Conclusion:**
- âœ… Order was paid on WooCommerce
- âœ… Order transferred to CounterPoint
- âœ… All information transferred correctly
- âœ… Payment was successful (evidenced by order status and notes)

---

**Last Updated:** January 5, 2026
